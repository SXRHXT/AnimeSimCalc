<style>
  /* ======================
     CALCULATOR CARD STYLES
     ====================== */
  /* Inputs, selects, textareas */
  .calculator-card input,
  .calculator-card select,
  .calculator-card textarea {
    background: #2a2a2a;
    color: #ffffff;
    border: 1px solid #ffffff;
    border-radius: 8px;
    padding: 0.6rem 1rem;
    font-size: 1rem;
    line-height: 1.4;
    box-sizing: border-box;
    box-shadow: 0 0 6px rgba(255, 255, 255, 0.6),
                0 0 10px rgba(255, 255, 255, 0.4);
    transition: box-shadow 0.3s ease, border-color 0.3s ease, background 0.3s ease;
  }
  .calculator-card input:hover, .calculator-card select:hover, .calculator-card textarea:hover,
  .calculator-card input:focus, .calculator-card select:focus, .calculator-card textarea:focus {
    background: #333333;
    border-color: #42e69588;
    box-shadow: 0 0 8px rgba(26, 188, 156, 0.6),
                0 0 15px rgba(26, 188, 156, 0.4);
    outline: none;
  }
  /* Remove spinner arrows in time & number inputs */
  .calculator-card input[type="time"]::-webkit-inner-spin-button,
  .calculator-card input[type="time"]::-webkit-clear-button,
  .calculator-card input[type="number"]::-webkit-inner-spin-button,
  .calculator-card input[type="number"]::-webkit-outer-spin-button {
    -webkit-appearance: none;
    margin: 0;
  }
  /* Checkbox styling */
  .calculator-card input[type="checkbox"] {
    appearance: none;
    border: 2px solid #aaa;
    border-radius: 4px;
    position: relative;
    cursor: pointer;
    vertical-align: middle;
    margin-right: 8px;
    background-color: #fff;
    width: 10px;
    height: 10px;
    transition: all 0.2s ease;
    display: inline-block;
  }
  .calculator-card input[type="checkbox"]:checked {
    background-color: #4cbd84;
    border-color: #42e695;
  }
  .calculator-card input[type="checkbox"]:checked::after {
    content: "";
    position: absolute;
    left: 12px;
    top: 0px;
    width: 6px;
    height: 12px;
    border: solid #fff;
    border-width: 0 2px 2px 0;
    transform: rotate(45deg);
  }
  /* Inputs in calculator cards lighter than card */
  .calculator-card .form-input,
  .calculator-card .form-select {
    background: #23232e !important;
    color: #fff;
    border: 1px solid #35354a;
  }
  /* Checkbox-labels: white, not bold */
  .calculator-card label.checkbox-label {
    font-weight: normal !important;
    color: #fff !important;
  }
  /* Less space between label and input/select */
  .calculator-card .form-group label.form-label + .form-input,
  .calculator-card .form-group label.form-label + .form-select,
  .calculator-card .form-group label.checkbox-label + .form-input,
  .calculator-card .form-group label.checkbox-label + .form-select {
    margin-top: -2px !important;
  }
  .calculator-card .form-group label.form-label,
  .calculator-card .form-group label.checkbox-label {
    margin-bottom: -2px !important;
  }
  /* Consistent spacing for label+input/select groups */
  .calculator-card .form-group {
    margin-bottom: 18px;
  }
  .calculator-card label.form-label,
  .calculator-card label.checkbox-label {
    display: block;
    margin-bottom: 7px;
  }
  /* Force white, bold, Oxanium labels above inputs */
  .calculator-card label.form-label {
    color: #fff !important;
    font-weight: bold !important;
    font-family: 'Oxanium', sans-serif !important;
    letter-spacing: 0.01em;
    font-size: 1.08em;
  }
  .calculator-card label.checkbox-label {
    color: #fff !important;
    font-weight: normal !important;
    font-family: 'Oxanium', sans-serif !important;
    letter-spacing: 0.01em;
    font-size: 1.08em;
  }

  /* ======================
     CALCULATOR CARD LAYOUT
     ====================== */
  .calculator-card,
  .gain-card,
  .goal-card,
  .coin-card {
    min-height: 605px !important;
    min-width: 420px !important;
    max-width: 500px !important;
    height: 100%;
    box-sizing: border-box;
  }

  /* ======================
     TRADING CARD STYLES
     ====================== */
  .trading-card, .trading-card .trade-panel, .trading-card .companion-item, .trading-card .modal-content {
    background: #222225 !important;
  }
  .trading-card input,
  .trading-card select,
  .trading-card .amount-input {
    background: #222225 !important;
    color: #fff;
    border: 1px solid #1a1a1a;
    transition: background 0.2s
  }
  .trading-card .add-companion-btn {
    background: #23232e !important;
    transition: background 0.2s;
  }
  .trading-card .add-companion-btn:hover,
  .trading-card .add-companion-btn:active {
    background: #353545 !important;
  }
  /* Trading card font and header */
  .trading-card, .trading-card * {
    font-family: 'Oxanium', sans-serif !important;
    color: #fff !important;
  }
  .trading-card .calculator-title {
    font-family: 'Oxanium', sans-serif !important;
    font-size: 2rem !important;
    font-weight: bold;
    color: #fff !important;
    text-shadow:
      0 0 15px #ff6ec4,
      0 0 25px #7873f5,
      0 0 35px #42e695;
    letter-spacing: 0.5px;
    text-align: center;
  }

  /* ======================
     RESULT/UTILITY CLASSES
     ====================== */
  .result { display: none; }
  .result.active { display: block; }
  .result.show { display:block !important; }
</style>
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Anime Simulator Calculators</title>
  <link href="https://fonts.googleapis.com/css2?family=Oxanium:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
    --bg-dark: #111;
    --bg-card: #23232e;
      --bg-element: #252542;
      --success: #22c55e;
      --error: #ef4444;
      --gold: #FFD700;
      --atomic: #50C878;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    .result {
      margin-top: 1rem;
      background: #2c2b2b;
      padding: 1rem;
      border-left: 5px solid #16a085;
      border-radius: 8px;
      display: none;
      opacity: 0;
      transition: opacity 0.5s ease;
      color: #fff;
    }

    .result.show {
      display: block;
      opacity: 1;
    }

    .result div {
      display: flex;
      justify-content: space-between;
      margin-bottom: 0.4rem;
    }

    .result div.bold {
      font-weight: bold;
      border-top: 1px solid #ccc;
      margin-top: 0.5rem;
      padding-top: 0.5rem;
    }
    
    body {
      font-family: 'Oxanium', sans-serif;
      background: var(--bg-dark);
      color: var(--text-main);
      min-height: 100vh;
      padding: 1rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      position: relative;
      overflow-x: hidden;
    }
    
    /* Animated Background */
    .bg-anime {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      opacity: 0.15;
      background: 
        radial-gradient(circle at 10% 20%, rgba(126, 34, 206, 0.4) 0%, transparent 20%),
        radial-gradient(circle at 90% 70%, rgba(6, 182, 212, 0.4) 0%, transparent 20%),
        radial-gradient(circle at 50% 30%, rgba(249, 115, 22, 0.3) 0%, transparent 30%);
      animation: pulseBackground 15s ease infinite;
    }
    
    @keyframes pulseBackground {
      0%, 100% { opacity: 0.1; }
      50% { opacity: 0.2; }
    }
    
    .bg-particles {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -2;
      overflow: hidden;
    }
    
    .particle {
      position: absolute;
      background: var(--primary);
      border-radius: 50%;
      opacity: 0.15;
      animation: float linear infinite;
    }
    
    @keyframes float {
      to { transform: translateY(-100vh) translateX(20vw); }
    }
    
    /* Header & Navigation */
    .header {
      width: 100%;
      max-width: 1200px;
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-bottom: 1rem;
    }
    
    .logo-container {
      display: flex;
      align-items: center;
      margin-bottom: 0.5rem;
    }
    
    .logo {
      width: 50px;
      height: 50px;
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 0.75rem;
      box-shadow: 0 0 15px var(--primary-glow);
    }
    
    .logo i {
      font-size: 1.5rem;
      color: white;
    }
    
    .title {
      font-size: 2rem;
      background: linear-gradient(90deg, var(--primary), var(--secondary));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-shadow: 0 0 10px rgba(126, 34, 206, 0.3);
    }
    
    .subtitle {
      color: var(--text-secondary);
      font-size: 0.9rem;
      text-align: center;
      max-width: 600px;
      margin-bottom: 1rem;
    }
    
    .header-card {
      position: relative;
      width: 100%;
      max-width: 900px;
      height: 180px;
      margin-bottom: 2.3rem;
      border-radius: 20px;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      padding: 1.2rem 1.5rem 1.2rem 1.5rem;
      z-index: 2;
      background: #1c1c1c;
    }
    .header-card::before {
      content: '';
      position: absolute;
      top: -350%;
      left: -350%;
      width: 800%;
      height: 800%;
      border-radius: 50%;
      background: conic-gradient(
        #ff6ec4,
        #7873f5,
        #42e695,
        #ff6ec4
      );
      z-index: 0;
      animation: rotateGradient 6s linear infinite;
      filter: blur(120px);
      pointer-events: none;
    }

    .header-card::after {
      content: '';
      position: absolute;
      inset: 3px;
      border-radius: 20px;
      background: #1c1c1c;
      z-index: 1;
    }
    .header-card > * {
      position: relative;
      z-index: 3;
    }
    @keyframes rotateGradient {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    .header-buttons .card-btn {
      background: rgba(20, 20, 30, 0.8);
      border-radius: 25px;
      border: 3px solid transparent;
      color: #fff;
      font-family: 'Oxanium', sans-serif;
      font-size: 1.3rem;
      font-weight: bold;
      padding: 1rem 2rem;
      cursor: pointer;
      /* transparante box-shadow zodat breedte altijd gelijk blijft */
      box-shadow: 0 0 0 4px rgba(66,230,149,0), 0 0 18px rgba(66,230,149,0), 0 0 36px rgba(66,230,149,0);
      transition: transform 0.3s, box-shadow 0.3s, background 0.3s;
      margin-bottom: 0;
    }
    .header-buttons .card-btn:hover {
      background: rgba(20, 20, 30, 0.8);
      color: #fff;
      border-color: #42e695;
      box-shadow: 0 0 0 4px #42e69544, 0 0 18px #42e69588, 0 0 36px #42e69544;
      transform: scale(1.12);
      transition: border-color 0.2s, box-shadow 0.2s, transform 0.2s;
    }

    .header-buttons .card-btn.active {
      color: #fff;
      border-color: #42e695;
      box-shadow: 0 0 0 4px #42e69544, 0 0 18px #42e69588, 0 0 36px #42e69544;
    }
    
    /* Main Container */
    .main-container {
      width: 100%;
      max-width: 1200px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    
    .calculator-container {
      background: linear-gradient(to bottom, rgba(26, 26, 46, 0.95), rgba(26, 26, 46, 0.85));
      backdrop-filter: blur(10px);
      padding: 1.5rem;
      border-radius: 1rem;
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
      border: 1px solid var(--border);
      position: relative;
      overflow: hidden;
      width: 100%;
      max-width: 800px;
      margin-bottom: 1rem;
    }
    
    .calculator-container::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, var(--primary), var(--secondary));
    }
    
    .calculator-title {
      font-size: 1.3rem;
      margin-bottom: 0.4rem;
      color: var(--primary-glow);
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .calculator-subtitle {
      color: var(--text-secondary);
      font-size: 0.85rem;
      margin-bottom: 1.2rem;
    }
    
    /* Form Elements */
    .form-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 1rem;
      margin-bottom: 1.2rem;
    }
    
    @media (min-width: 640px) {
      .form-grid {
        grid-template-columns: 1fr 1fr;
      }
    }
    
    .form-group {
      display: flex;
      flex-direction: column;
      gap: 0.4rem;
    }
    
    .form-label {
      font-size: 0.85rem;
      color: var(--text-secondary);
      display: flex;
      align-items: center;
      gap: 0.25rem;
    }
    
    .form-input, .form-select {
      background: var(--bg-element);
      border: 1px solid var(--border);
      border-radius: 0.6rem;
      padding: 0.6rem 0.8rem;
      color: var(--text-main);
      font-size: 0.9rem;
      font-family: 'Oxanium', sans-serif;
      transition: all 0.3s ease;
    }
    
    .form-input:focus, .form-select:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(126, 34, 206, 0.3);
    }
    
    .checkbox-group {
      display: flex;
      gap: 0.8rem;
      margin-bottom: 0.8rem;
    }
    
    .checkbox-label {
      display: flex;
      align-items: center;
      gap: 0.4rem;
      font-size: 0.85rem;
      color: var(--text-secondary);
      cursor: pointer;
    }
    
    .checkbox-input {
      width: 16px;
      height: 16px;
      accent-color: var(--primary);
    }
    
    /* Sections */
    .section {
      background: rgba(37, 37, 66, 0.5);
      padding: 1rem;
      border-radius: 0.6rem;
      margin-bottom: 1.2rem;
      border: 1px solid rgba(76, 76, 120, 0.3);
    }
    
    .section-title {
      font-size: 1rem;
      margin-bottom: 0.8rem;
      color: var(--secondary);
      display: flex;
      align-items: center;
      gap: 0.4rem;
    }
    
    /* Buttons */

    .btn {
      background: linear-gradient(135deg, #42e695, #42e695);
      color: #111;
      font-size: 0.9rem;
      font-weight: 700;
      padding: 0.7rem;
      border: 2px solid #42e695;
      border-radius: 0.6rem;
      cursor: pointer;
      width: 100%;
      transition: all 0.3s ease;
      font-family: 'Oxanium', sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.4rem;
      box-shadow: 0 0 0 0 #42e695;
    }
    
    .btn-secondary {
      background: var(--bg-element);
      color: var(--text-main);
    }
    
    .btn-secondary:hover {
      box-shadow: 0 6px 15px rgba(76, 76, 120, 0.3);
    }
    
    /* Profile Controls */
    .profile-controls {
      display: flex;
      gap: 0.4rem;
      margin-top: 0.8rem;
    }
    
    .profile-input {
      flex-grow: 1;
      background: var(--bg-element);
      border: 1px solid var(--border);
      border-radius: 0.6rem;
      padding: 0.4rem 0.8rem;
      color: var(--text-main);
      font-family: 'Oxanium', sans-serif;
      font-size: 0.85rem;
    }
    
    .profile-btn {
      background: var(--bg-element);
      color: var(--text-main);
      border: 1px solid var(--border);
      border-radius: 0.6rem;
      padding: 0.4rem 0.6rem;
      cursor: pointer;
      font-size: 0.85rem;
      transition: all 0.2s;
      font-family: 'Oxanium', sans-serif;
    }
    
    .profile-btn:hover {
      background: var(--primary);
      color: white;
    }
    
    /* Results */
    .result {
      margin-top: 1.5rem;
      background: rgba(37, 37, 66, 0.7);
      padding: 1.2rem;
      border-radius: 0.6rem;
      border-left: 3px solid var(--primary);
      font-size: 0.9rem;
    }
    
    .result-item {
      margin-bottom: 0.6rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .result-label {
      color: var(--text-secondary);
    }
    
    .result-value {
      font-weight: 600;
      color: var(--primary-glow);
    }
    
    /* Tooltips */
    .tooltip {
      position: relative;
      display: inline-block;
      width: 14px;
      height: 14px;
      background: var(--primary);
      color: var(--bg-dark);
      border-radius: 50%;
      text-align: center;
      font-size: 10px;
      line-height: 14px;
      cursor: help;
    }
    
    .tooltip .tooltiptext {
      visibility: hidden;
      width: 180px;
      background-color: var(--bg-element);
      color: var(--text-main);
      text-align: center;
      border-radius: 6px;
      padding: 6px;
      position: absolute;
      z-index: 1;
      bottom: 125%;
      left: 50%;
      transform: translateX(-50%);
      opacity: 0;
      transition: opacity 0.3s;
      font-size: 0.75rem;
      border: 1px solid var(--border);
    }
    
    .tooltip:hover .tooltiptext {
      visibility: visible;
      opacity: 1;
    }
    
    /* Tabs */
    .tab-content {
      display: none;
      width: 100%;
      align-items: center;
      flex-direction: column;
    }
    
    .tab-content.active {
      display: flex;
    }
    
    /* Animations */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .calculator-container {
      animation: fadeIn 0.5s ease-out;
    }
    
    /* Trading Calculator Styles */
    .trade-container {
      display: grid;
      grid-template-columns: 1fr;
      gap: 1.2rem;
    }
    
    @media (min-width: 768px) {
      .trade-container {
        grid-template-columns: 1fr 1fr;
      }
    }
    
    .trade-panel {
      background: #1c1c1c;
      padding: 1.2rem;
      border-radius: 20px;
      border: 1px solid rgba(76, 76, 120, 0.5);
      min-height: 340px;
      max-height: 340px;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      position: relative;
      overflow: hidden;
      z-index: 0;
      box-shadow: 0 0 18px 2px rgba(255,255,255,0.10), 0 2px 8px 0 rgba(66,230,149,0.08);
      margin-left: 24px;
      margin-right: 24px;
    }

    .trade-panel::before {
      content: '';
      position: absolute;
      top: -120%;
      left: -120%;
      width: 340%;
      height: 340%;
      border-radius: 50%;
      background: conic-gradient(
        #ff6ec4,
        #7873f5,
        #42e695,
        #ff6ec4
      );
      z-index: -1;
      animation: rotateGradient 6s linear infinite;
      filter: blur(50px);
    }
    .trade-panel::after {
      content: '';
      position: absolute;
      inset: 3px;
      border-radius: 20px;
      background: #1c1c1c;
      z-index: -1;
    }
    
    .panel-title {
      font-size: 1.3rem;
      margin-bottom: 0.8rem;
      color: #fff !important;
      text-align: center;
      font-weight: bold;
      text-shadow:
        0 0 15px #ff6ec4,
        0 0 25px #7873f5,
        0 0 35px #42e695;
      letter-spacing: 0.5px;
      font-family: 'Oxanium', sans-serif !important;
    }

  .btn-reset-trade {
      background: linear-gradient(135deg, #ef4444, #b91c1c) !important;
      color: #fff !important;
      border: 2px solid #ef4444 !important;
      box-shadow: none !important;
    }
  .btn-reset-trade:hover,
  .btn-reset-trade:active {
      background: linear-gradient(135deg, #ef4444, #b91c1c) !important;
      color: #fff !important;
      border: 2px solid #ef4444 !important;
      box-shadow: 0 0 0 4px #ef444444, 0 0 18px #ef444488, 0 0 36px #ef444444 !important;
      outline: none !important;
      transition: background 0.2s, color 0.2s, border-color 0.2s, box-shadow 0.2s, transform 0.35s cubic-bezier(.4,1.4,.6,1) !important;
      transform: scale(1.06);
    }
    .btn-reset-trade:active {
      transform: scale(0.98) !important;
    }

      /* Calculate Trade button: green gradient, same style as reset trade */
      .btn-calculate-trade {
        background: linear-gradient(135deg, #42e695, #15803d) !important;
        color: #fff !important;
        border: 2px solid #42e695 !important;
        box-shadow: none !important;
      }
  .btn-calculate-trade:hover,
  .btn-calculate-trade:active {
        background: linear-gradient(135deg, #42e695, #15803d) !important;
        color: #fff !important;
        border: 2px solid #42e695 !important;
        box-shadow: 0 0 0 4px #42e69544, 0 0 18px #42e69588, 0 0 36px #42e69544 !important;
        outline: none !important;
        transition: background 0.2s, color 0.2s, border-color 0.2s, box-shadow 0.2s, transform 0.35s cubic-bezier(.4,1.4,.6,1) !important;
        transform: scale(1.06);
      }
      .btn-calculate-trade:active {
        transform: scale(0.98) !important;
      }

  /* Removed focus/focus-visible/focus-within to prevent persistent active state */
    
    .add-companion-btn {
      background: #353545; /* Lighter grey */
      border: 2px solid #fff;
      border-radius: 0.6rem;
      box-shadow: 0 0 8px 2px #fff8, 0 0 0 0 #42e69500;
      padding: 1.2rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: background 0.2s, color 0.2s, border-color 0.2s, box-shadow 0.2s;
      color: #bdbdbd;
      font-size: 0.9rem;
      margin-bottom: 0.1rem;
    }

    .add-companion-btn:hover {
      background: #42e695;
      color: #111;
      border-color: #42e695;
      box-shadow: 0 0 12px 2px #42e69588, 0 0 0 0 #fff0;
    }
    
    .add-companion-btn i {
      font-size: 1.7rem;
      margin-bottom: 0.4rem;
    }
    
    .selected-companions {
      display: flex;
      flex-direction: column;
      gap: 0.6rem;
    }
    
    .companion-item {
      background: var(--bg-element);
      border-radius: 0.4rem;
      padding: 0.6rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      position: relative;
      font-size: 0.85rem;
    }
    
    .companion-info {
      display: flex;
      align-items: center;
      gap: 0.6rem;
    }
    
    .companion-image {
      width: 35px;
      height: 35px;
      object-fit: contain;
      border-radius: 50%;
      background: var(--bg-dark);
      padding: 2px;
    }
    
    .companion-name {
      font-weight: 600;
    }
    
    .companion-amount {
      display: flex;
      align-items: center;
      gap: 0.4rem;
    }
    
    .amount-input {
      background: var(--bg-dark);
      border: 1px solid var(--border);
      border-radius: 0.4rem;
      padding: 0.3rem 0.4rem;
      color: var(--text-main);
      width: 50px;
      text-align: center;
      font-family: 'Oxanium', sans-serif;
      font-size: 0.8rem;
    }
    
    .remove-btn {
      background: none;
      border: none;
      color: var(--error);
      cursor: pointer;
      font-size: 1.1rem;
      display: flex;
      align-items: center;
    }
    
    /* Companion Select Modal */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      z-index: 100;
      align-items: center;
      justify-content: center;
    }
    
    .modal-content {
      background: var(--bg-card);
      border-radius: 0.6rem;
      width: 90%;
      max-width: 720px;
      max-height: 425px;
      overflow-y: auto;
      padding: 1.2rem;
      border: 1px solid var(--primary);
      box-shadow: 0 0 25px rgba(126, 34, 206, 0.3);
        scrollbar-width: thin;
        scrollbar-color: #42e695 #23232e;
      }

      /* Custom scrollbar for modal-content (Webkit browsers) */
      .modal-content::-webkit-scrollbar {
        width: 8px;
        background: transparent;
      }
      .modal-content::-webkit-scrollbar-thumb {
        background: linear-gradient(135deg, #42e695 60%, #7e22ce 100%);
        border-radius: 6px;
        min-height: 40px;
      }
      .modal-content::-webkit-scrollbar-track {
        background: transparent;
      }
    
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.2rem;
    }
    
    .modal-title {
      font-size: 1.3rem;
      color: var(--primary);
    }
    
    .close-modal {
      background: none;
      border: none;
      color: var(--text-secondary);
      font-size: 1.3rem;
      cursor: pointer;
    }
    
    .item-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(90px, 1fr));
      gap: 0.8rem;
      min-height: 320px;
      /* Zorg dat de grid altijd even groot blijft, ook als er weinig items zijn */
      align-items: start;
    }
    
    .item-option {
      background: var(--bg-element);
      border-radius: 0.4rem;
      padding: 0.6rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      cursor: pointer;
      transition: all 0.2s;
      border: 1px solid transparent;
    }

    .item-option img {
      width: 45px;
      height: 45px;
      object-fit: contain;
      margin-bottom: 0.4rem;
      background: var(--bg-dark);
      border-radius: 50%;
      padding: 4px;
    }

    .item-option span {
      font-size: 0.75rem;
      text-align: center;
    }

    .item-value {
      font-size: 0.65rem;
      color: var(--primary);
      margin-top: 0.2rem;
    }
    
    /* Trait Selector */
    .trait-selector {
      position: absolute;
      top: -8px;
      right: -8px;
      background: var(--bg-element);
      border-radius: 50%;
      width: 20px;
      height: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      z-index: 1;
      border: 1px solid var(--border);
      font-size: 0.7rem;
    }
    
    .trait-options {
      position: absolute;
      top: 25px;
      right: 0;
      background: var(--bg-element);
      border-radius: 0.4rem;
      padding: 0.4rem;
      display: none;
      flex-direction: column;
      gap: 0.4rem;
      z-index: 2;
      border: 1px solid var(--border);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    }
    
    .trait-option {
      padding: 0.2rem 0.4rem;
      border-radius: 0.2rem;
      cursor: pointer;
      font-size: 0.7rem;
      white-space: nowrap;
    }
    
    .trait-option:hover {
      background: var(--bg-dark);
    }
    
    .trait-option.normal {
      color: var(--text-main);
    }
    
    .trait-option.gold {
      color: var(--gold);
    }
    
    .trait-option.atomic {
      color: var(--atomic);
    }
    
    .trait-indicator {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      display: inline-block;
      margin-right: 0.2rem;
    }
    
    .trait-indicator.normal {
      background: var(--text-secondary);
    }
    
    .trait-indicator.gold {
      background: var(--gold);
    }
    
    .trait-indicator.atomic {
      background: var(--atomic);
    }
    
    .trait-display {
      position: absolute;
      top: -6px;
      left: -6px;
      font-size: 0.6rem;
      padding: 0.1rem 0.25rem;
      border-radius: 0.2rem;
      font-weight: bold;
    }
    
    .trait-display.gold {
      background: var(--gold);
      color: #000;
    }
    
    .trait-display.atomic {
      background: var(--atomic);
      color: #000;
    }
    
    /* --- CALCULATOR CARD GLOW BORDER --- */
    .calculator-card, .gain-card, .goal-card, .coin-card {
      position: relative;
      background: #1c1c1c;
      border-radius: 20px;
      padding: 2rem;
      overflow: hidden;
      z-index: 0;
      max-width: 350px;
      width: 100%;
      display: flex;
      flex-direction: column;
      box-shadow: 
        0 0 15px rgba(0,0,0,0.7), 
        0 0 30px rgba(255,110,196,0.3),
        0 0 30px rgba(120,115,245,0.3),
        0 0 30px rgba(66,230,149,0.3);
      transition: transform 0.6s ease, box-shadow 0.6s ease;
      transform-style: preserve-3d;
    }

    .calculator-card::before, .gain-card::before, .goal-card::before, .coin-card::before {
      content: '';
      position: absolute;
      top: -120%;
      left: -120%;
      width: 340%;
      height: 340%;
      border-radius: 50%;
      background: conic-gradient(
        #ff6ec4,
        #7873f5,
        #42e695,
        #ff6ec4
      );
      z-index: -1;
      animation: rotateGradient 6s linear infinite;
      filter: blur(50px);
    }
    .calculator-card::after, .gain-card::after, .goal-card::after, .coin-card::after {
      content: '';
      position: absolute;
      inset: 3px;
      border-radius: 20px;
      background: #1c1c1c;
      z-index: -1;
    }
    @keyframes rotateGradient {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .calculator-title {
  text-align: center !important;
  width: 100%;
  display: block;
  font-size: 1.9rem !important;
    }
    /* --- ZORG DAT DE JUISTE CLASSES WORDEN TOEGEPAST OP DE HTML --- */
    /* Je kunt in je HTML bij elke calculator card toevoegen: class="calculator-card gain-card" of goal-card/coin-card */
    /* Bijvoorbeeld: <div class="calculator-card gain-card"> ... </div> */
  </style>
</head>
<body>
  

<!-- HEADER CARD -->
<div class="card header-card" style="margin-bottom: 2.3rem; max-width: 900px; display: flex; flex-direction: column; align-items: center; justify-content: center;">
  <h1 style="font-size: 3rem; font-weight: bold; color: #fff !important; text-shadow: 0 0 15px #ff6ec4, 0 0 25px #7873f5, 0 0 35px #42e695; margin: 0 0 0.5rem 0; padding-top: 0.2rem; position: relative; z-index: 5;">Anime Simulator Calculators</h1>
  <div class="header-buttons" style="margin-top: 0.2rem; display: flex; gap: 1rem;">
<button class="card-btn nav-btn active" id="tab-calculators">Calculators</button>
<button class="card-btn nav-btn" id="tab-trading">Trading</button>
  </div>
</div>


  <div class="main-container" style="position:relative;">
    <div id="calculators-section">
  <div style="display: flex; gap: 32px; justify-content: center; align-items: flex-start; flex-wrap: nowrap; margin-bottom: 32px;">
        <!-- Stats Calculator (links) -->
  <div class="calculator-container calculator-card gain-card" style="flex: 1 1 0; min-width: 0;">
          <h2 class="calculator-title" style="font-size: 1.6rem; font-weight: bold; color: #fff !important; text-shadow: 0 0 15px #ff6ec4, 0 0 25px #7873f5, 0 0 35px #42e695; margin: 0 0 1.2rem 0; padding-top: 0.2rem; position: relative; z-index: 5; font-family: 'Oxanium', sans-serif; letter-spacing: 0.5px; text-align: center;">Stats Gain</h2>
          <div class="form-group">
            <label for="statType" class="form-label">Training Type</label>
            <select id="statType" class="form-select">
              <option value="strength">Strength</option>
              <option value="energy">Energy</option>
              <option value="defense">Defense</option>
              <option value="sword">Sword</option>
              <option value="speed">Speed</option>
              <option value="jump">Jump</option>
            </select>
          </div>
          <div class="form-group">
            <label for="gainPerTick" class="form-label">Gain Per Tick</label>
            <input type="text" id="gainPerTick" class="form-input" required>
          </div>
          <div class="form-group">
            <label for="time" class="form-label">Time (minutes)</label>
            <input type="number" id="time" class="form-input" required>
          </div>
          <div class="form-group">
            <label for="companionActive" class="form-label">Use Companion?</label>
            <select id="companionActive" class="form-select">
              <option value="true">Yes</option>
              <option value="false" selected>No</option>
            </select>
          </div>
          <div class="form-group">
            <div class="form-group" id="companionGainGroup">
              <label for="companionGain" class="form-label">Companion Gain Per Tick</label>
              <input type="text" id="companionGain" class="form-input" required>
            </div>
          </div>
          <button class="btn btn-calculate-trade" id="calculateBtn" style="margin-top:-8px; font-size:1.15rem;">Calculate Gains</button>
          <div class="result" id="result"></div>
        </div>
        <!-- Goal Calculator (midden) -->
  <div class="calculator-container calculator-card goal-card" style="flex: 1 1 0; min-width: 0;">
          <h2 class="calculator-title" style="font-size: 1.6rem; font-weight: bold; color: #fff !important; text-shadow: 0 0 15px #ff6ec4, 0 0 25px #7873f5, 0 0 35px #42e695; margin: 0 0 1.2rem 0; padding-top: 0.2rem; position: relative; z-index: 5; font-family: 'Oxanium', sans-serif; letter-spacing: 0.5px; text-align: center;">Goal Planner</h2>
          <div class="form-group">
            <label for="goalStatType" class="form-label">Training Type</label>
            <select id="goalStatType" class="form-select" style="width:100%;">
              <option value="strength">Strength</option>
              <option value="energy">Energy</option>
              <option value="defense">Defense</option>
              <option value="sword">Sword</option>
              <option value="speed">Speed</option>
              <option value="jump">Jump</option>
            </select>
          </div>
          <div class="form-group">
            <label for="currentStatNew" class="form-label">Current Stat</label>
            <input type="text" id="currentStatNew" class="form-input" autocomplete="off" style="width:100%;">
          </div>
          <div class="form-group">
            <label for="desiredStatNew" class="form-label">Desired Stat</label>
            <input type="text" id="desiredStatNew" class="form-input" autocomplete="off" style="width:100%;">
          </div>
          <div class="form-group">
            <label for="goalGainNew" class="form-label">Gain per Tick</label>
            <input type="text" id="goalGainNew" class="form-input" autocomplete="off" style="width:100%;">
          </div>
          <div class="form-group">
            <label for="goalUseCompanion" class="form-label">Use Companion?</label>
            <select id="goalUseCompanion" class="form-select" style="width:100%;">
              <option value="yes">Yes</option>
              <option value="no" selected>No</option>
            </select>
          </div>
          <div class="form-group">
            <div class="form-group" id="goalCompanionGainGroup">
              <label for="goalCompanionGain" class="form-label">Companion Gain per Tick</label>
              <input type="text" id="goalCompanionGain" class="form-input" autocomplete="off" style="width:100%;">
            </div>
          </div>
          <button class="btn btn-calculate-trade" id="calculateGoalNewBtn" style="margin-top:-8px; font-size:1.15rem;">Calculate Time</button>
          <div class="result" id="goalResultNew"></div>
        </div>
        <!-- CUrrency Calculator (rechts) -->
  <div class="calculator-container calculator-card coin-card" style="flex: 1 1 0; min-width: 0;">
          <h2 class="calculator-title" style="font-size: 1.6rem; font-weight: bold; color: #fff !important; text-shadow: 0 0 15px #ff6ec4, 0 0 25px #7873f5, 0 0 35px #42e695; margin: 0 0 1.2rem 0; padding-top: 0.2rem; position: relative; z-index: 5; font-family: 'Oxanium', sans-serif; letter-spacing: 0.5px; text-align: center;">Currency Calculator</h2>
          <div class="form-group">
            <label for="rankSelect" class="form-label">Select Rank</label>
            <select id="rankSelect" class="form-select" style="width:100%;">
              <option value="0">Rookie</option>
              <option value="1">Ninja</option>
              <option value="2">Pirate</option>
              <option value="3">Ghoul</option>
              <option value="4">Hero</option>
              <option value="5">Reaper</option>
              <option value="6">Warrior</option>
              <option value="7">Sin</option>
              <option value="8">Mage</option>
              <option value="9">Demon</option>
              <option value="10">Emperor</option>
              <option value="11">Elder</option>
              <option value="12">Overlord</option>
              <option value="13">Leader</option>
              <option value="14">Deity</option>
              <option value="15">Sage</option>
              <option value="16">Mask</option>
              <option value="17">Shinigami</option>
              <option value="18">Hashira</option>
              <option value="19">Destroyer</option>
              <option value="20">Otsutsuki</option>
              <option value="21">Pirate King</option>
            </select>
          </div>
          <div class="form-group">
            <label class="checkbox-label"><input type="checkbox" id="doubleCoins" class="checkbox-input"> 2x Coins Gamepass</label>
          </div>
          <div class="form-group">
            <label class="checkbox-label"><input type="checkbox" id="doubleGems" class="checkbox-input"> 2x Gems Gamepass</label>
          </div>
          <div class="form-group">
            <label class="checkbox-label"><input type="checkbox" id="goldCompanion" class="checkbox-input"> Gold Companion (+20%)</label>
          </div>
          <div class="form-group">
            <label for="coinTimeInput" class="form-label">Time (minutes)</label>
            <input type="number" id="coinTimeInput" class="form-input" required style="width:100%;">
          </div>
          <button class="btn btn-calculate-trade" id="calculateCoinsBtn" style="font-size:1.15rem; margin-top:10px;">Calculate Earnings</button>
          <div class="result" id="coinResult"></div>
        </div>
      </div>
    </div>


    <div id="trading-section" style="display:none;">
  <div class="calculator-container calculator-card trading-card">
<style>
  /* Specifiek voor de trading calculator kaart */
  .trading-card {
  min-width: 1200px !important;
  max-width: 1800px !important;
  min-height: 420px !important;
  width: 100%;
  }

  .item-images-row {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    max-height: 150px; /* Meer ruimte voor badges */
    overflow-y: auto;
    overflow-x: hidden;
    border-radius: 8px;
    margin-bottom: 18px;
    scrollbar-width: thin;
    scrollbar-color: #42e695 #23232e;
    background: transparent;
    padding-bottom: 10px; /* Iets meer padding onder */
  }

  /* Badge op de item image */
  .item-badge, .amount-badge {
    position: absolute;
    top: -10px;
    right: -10px;
    min-width: 22px;
    min-height: 22px;
    background: #42e695;
    color: #111;
    font-size: 0.85rem;
    font-weight: bold;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 2px 8px rgba(0,0,0,0.15);
    z-index: 3;
    border: 2px solid #23232e;
    pointer-events: none;
  }
  .item-images-row::-webkit-scrollbar {
    width: 10px;
    background: transparent;
  }
  .item-images-row::-webkit-scrollbar-thumb {
    background: linear-gradient(135deg, #42e695 60%, #7e22ce 100%);
    border-radius: 6px;
    min-height: 40px;
  }
  .item-images-row::-webkit-scrollbar-track {
    background: transparent;
  }
  @media (max-width: 900px) {
    .trading-card {
      min-width: 98vw !important;
      max-width: 100vw !important;
    }
  }
</style>
  <h2 class="calculator-title">Trading Calculator</h2>
        <br>
        <div class="trade-container">
          <!-- Your Offer Panel -->
          <div class="trade-panel">
            <h2 class="panel-title">Your Offer</h2>
            <div class="item-images-row" id="your-offer-images"></div>
            <div class="selected-companions" id="your-offer" style="display:none;"></div>
            <div style="margin-top:auto;">
              <div class="add-companion-btn" id="add-your-companion" style="width:100%;">
                <i class="fas fa-plus"></i>
                <span>Add Item</span>
              </div>
            </div>
          </div>
          <!-- Their Offer Panel -->
          <div class="trade-panel">
            <h2 class="panel-title">Their Offer</h2>
            <div class="item-images-row" id="their-offer-images"></div>
            <div class="selected-companions" id="their-offer" style="display:none;"></div>
            <div style="margin-top:auto;">
              <div class="add-companion-btn" id="add-their-companion" style="width:100%;">
                <i class="fas fa-plus"></i>
                <span>Add Item</span>
              </div>
            </div>
          </div>
        </div>
  <div style="display:flex; justify-content:center; align-items:center; gap:32px; margin-top:2.2rem;">
          <button class="btn btn-reset-trade" id="reset-trade" style="max-width:220px; width:100%; font-size:1.15rem;">Reset Trade</button>
          <button class="btn btn-calculate-trade" id="calculate-trade" style="max-width:220px; width:100%; font-size:1.15rem;">Calculate Trade</button>
        </div>
        <div class="result" id="trade-result">
          <div class="result-item">
            <span>Your Offer Value:</span>
            <span class="result-value" id="your-value">0</span>
          </div>
          <div class="result-item">
            <span>Their Offer Value:</span>
            <span class="result-value" id="their-value">0</span>
          </div>
          <div class="result-item" style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--border);">
            <span style="font-weight: 700;">Trade Result:</span>
            <span class="result-value" style="font-weight: 700;" id="trade-result-text">Fair Trade</span>
          </div>
          <div class="result-item">
            <span>Difference:</span>
            <span class="result-value" id="difference-value">0</span>
          </div>
        </div>
        <!-- Companion Selection Modal (was missing, needed for Add Companion buttons) -->
        <div id="item-modal" class="modal" style="display:none;">
          <div class="modal-content">
            <div class="modal-header" style="flex-direction: column; align-items: stretch; gap: 0.7rem;">
              <div style="display: flex; gap: 0.7rem; justify-content: center; margin-bottom: 0.5rem;">
                <button id="btn-companions" class="btn btn-modal-tab active" style="flex:1; background:#42e695; color:#111; border-radius: 0.5rem 0 0 0.5rem; border: none; font-weight:700;">Companions</button>
                <button id="btn-auras" class="btn btn-modal-tab" style="flex:1; background:#23232e; color:#fff; border-radius: 0 0.5rem 0.5rem 0; border: none; font-weight:700;">Aura's</button>
              </div>
              <div style="display: flex; justify-content: space-between; align-items: center;">
                <h3 class="modal-title" style="margin:0;">Select Item</h3>
                <button id="close-modal" class="close-modal" aria-label="Close">&times;</button>
              </div>
            </div>
            <div class="item-grid" id="item-grid"></div>
          </div>
        </div>
      </div>
    </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Reset trade button: clears both offer boards (images only)
      document.getElementById('reset-trade').addEventListener('click', ()=>{
        yourOffer.length = 0;
        theirOffer.length = 0;
        updateOfferImages(yourOffer, document.getElementById('your-offer-images'));
        updateOfferImages(theirOffer, document.getElementById('their-offer-images'));
      });

  // Goal Planner Calculation (moved inside DOMContentLoaded for scoped vars)
  function calculateGoalNew() {
      const statType = document.getElementById("goalStatType").value;
      const gainPerTick = parseNumberWithSuffix(document.getElementById("goalGainNew").value);
      const companionGain = document.getElementById("goalUseCompanion").value === 'yes' ? parseNumberWithSuffix(document.getElementById("goalCompanionGain").value) : 0;
      const currentStat = parseNumberWithSuffix(document.getElementById("currentStatNew").value);
      const desiredStat = parseNumberWithSuffix(document.getElementById("desiredStatNew").value);
      const goalResultDiv = document.getElementById("goalResultNew");
      if (isNaN(gainPerTick)) {
        goalResultDiv.innerHTML = `<div class="result-item" style="color:var(--error)">Please enter a valid gain per tick</div>`;
        goalResultDiv.classList.add("show");
        return;
      }
      if (isNaN(currentStat)) {
        goalResultDiv.innerHTML = `<div class="result-item" style="color:var(--error)">Please enter your current stat value</div>`;
        goalResultDiv.classList.add("show");
        return;
      }
      if (isNaN(desiredStat) || desiredStat <= currentStat) {
        goalResultDiv.innerHTML = `<div class="result-item" style="color:var(--error)">Please enter a valid desired stat higher than current</div>`;
        goalResultDiv.classList.add("show");
        return;
      }
      const ticksPerMinuteGoal = ticksPerMinute[statType] || 0;
      const companionTicks = document.getElementById("goalUseCompanion").value === 'yes' ? 10 : 0;
      const neededGain = desiredStat - currentStat;
      const gainPerMinute = (gainPerTick * ticksPerMinuteGoal) + (companionGain * companionTicks);
      const minutesNeeded = neededGain / gainPerMinute;
      goalResultDiv.style.borderLeft = '5px solid #16a085'; // green
      goalResultDiv.innerHTML = `
        <div><span>Current:</span><span>${abbreviateNumber(currentStat)}</span></div>
        <div><span>Goal:</span><span>${abbreviateNumber(desiredStat)}</span></div>
        <div><span>Gain per Minute:</span><span>${abbreviateNumber(gainPerMinute)}</span></div>
        <div class="bold"><span>Time Needed:</span><span>${formatTime(minutesNeeded)}</span></div>
      `;
      goalResultDiv.classList.add("show");
    }

  // Bind Goal Planner Calculate button to patched function
  document.getElementById('calculateGoalNewBtn').addEventListener('click', calculateGoalNew);


      // Companion field toggles
      function toggleCompanion(selectId, groupId) {
        const select = document.getElementById(selectId);
        const group = document.getElementById(groupId);
        if (select && group) {
          group.style.display = (select.value === 'true' || select.value === 'yes') ? '' : 'none';
        }
      }
      // For Stats Gain
      toggleCompanion('companionActive', 'companionGainGroup');
      document.getElementById('companionActive').addEventListener('change', function() {
        toggleCompanion('companionActive', 'companionGainGroup');
      });
      // For Goal Planner
      toggleCompanion('goalUseCompanion', 'goalCompanionGainGroup');
      document.getElementById('goalUseCompanion').addEventListener('change', function() {
        toggleCompanion('goalUseCompanion', 'goalCompanionGainGroup');
      });

      // Hide/show Stats Gain Companion Gain field based on Use Companion selection
      const companionActive = document.getElementById('companionActive');
      const companionGainGroup = document.getElementById('companionGainGroup');
      function updateCompanionGainVisibility() {
        if (companionActive.value === 'true') {
          companionGainGroup.style.display = '';
        } else {
          companionGainGroup.style.display = 'none';
        }
      }
      companionActive.addEventListener('change', updateCompanionGainVisibility);
      updateCompanionGainVisibility();

      // Hide/show Goal Companion Gain field based on Use Companion selection
      const goalUseCompanion = document.getElementById('goalUseCompanion');
      const goalCompanionGainGroup = document.getElementById('goalCompanionGainGroup');
      function updateGoalCompanionGainVisibility() {
        if (goalUseCompanion.value === 'yes') {
          goalCompanionGainGroup.style.display = '';
        } else {
          goalCompanionGainGroup.style.display = 'none';
        }
      }
      goalUseCompanion.addEventListener('change', updateGoalCompanionGainVisibility);
      updateGoalCompanionGainVisibility();
      // Hoofd-tabs logica
      const tabCalculators = document.getElementById('tab-calculators');
      const tabTrading = document.getElementById('tab-trading');
      const calculatorsSection = document.getElementById('calculators-section');
      const tradingSection = document.getElementById('trading-section');

      tabCalculators.addEventListener('click', function() {
        tabCalculators.classList.add('active');
        tabTrading.classList.remove('active');
        calculatorsSection.style.display = '';
        tradingSection.style.display = 'none';
      });
      tabTrading.addEventListener('click', function() {
        tabTrading.classList.add('active');
        tabCalculators.classList.remove('active');
        calculatorsSection.style.display = 'none';
        tradingSection.style.display = '';
      });

      // Standaard: calculators zichtbaar
      calculatorsSection.style.display = '';
      tradingSection.style.display = 'none';
      


      // Tab functionality
      const tabButtons = document.querySelectorAll('.nav-btn');
      const tabContents = document.querySelectorAll('.tab-content');
      
      tabButtons.forEach(button => {
        button.addEventListener('click', () => {
          const tabId = button.getAttribute('data-tab');
          
          // Update active button
          tabButtons.forEach(btn => btn.classList.remove('active'));
          button.classList.add('active');
          
          // Show active tab
          tabContents.forEach(content => content.classList.remove('active'));
          document.getElementById(tabId).classList.add('active');
        });
      });

      // Stats Calculator Variables
      const ticksPerMinute = {
        strength: 55,
        energy: 28,
        defense: 36,
        sword: 55,
        speed: 39,
        jump: 39
      };
      const companionTicksPerMinute = 10;

      // Coin Calculator Variables
      const ranks = [
        { name: "Rookie", coinPerMinute: 5 },
        { name: "Ninja", coinPerMinute: 10 },
        { name: "Pirate", coinPerMinute: 25 },
        { name: "Ghoul", coinPerMinute: 50 },
        { name: "Hero", coinPerMinute: 100 },
        { name: "Reaper", coinPerMinute: 250 },
        { name: "Warrior", coinPerMinute: 500 },
        { name: "Sin", coinPerMinute: 1000 },
        { name: "Mage", coinPerMinute: 5000 },
        { name: "Demon", coinPerMinute: 10000 },
        { name: "Emperor", coinPerMinute: 50000 },
        { name: "Elder", coinPerMinute: 100000 },
        { name: "Overlord", coinPerMinute: 500000 },
        { name: "Leader", coinPerMinute: 1000000 },
        { name: "Deity", coinPerMinute: 5000000 },
        { name: "Sage", coinPerMinute: 10000000 },
        { name: "Mask", coinPerMinute: 50000000 },
        { name: "Shinigami", coinPerMinute: 100000000 },
        { name: "Hashira", coinPerMinute: 500000000 },
        { name: "Destroyer", coinPerMinute: 1000000000 },
        { name: "Otsutsuki", coinPerMinute: 5000000000 },
        { name: "Pirate King", coinPerMinute: 10000000000 }
      ];

      // Utility Functions
      function parseNumberWithSuffix(input) {
        if (!input) return NaN;
        if (/^[0-9.]+e[0-9]+$/i.test(input)) return parseFloat(input);
        input = input.toString().trim().toLowerCase();
        const suffixes = {
          'k':1e3,'m':1e6,'b':1e9,'t':1e12,'qd':1e15,'qn':1e18,
          'sx':1e21,'sp':1e24,'oc':1e27,'no':1e30,'dc':1e33
        };
        let suffix = '';
        let numberPart = input;
        for (const s in suffixes) {
          if (input.endsWith(s)) {
            suffix = s;
            numberPart = input.substring(0, input.length - s.length);
            break;
          }
        }
        const number = parseFloat(numberPart);
        return isNaN(number) ? NaN : suffix ? number * suffixes[suffix] : number;
      }

      function abbreviateNumber(num) {
        const units = [
          {v:1e33,s:"Dc"},{v:1e30,s:"No"},{v:1e27,s:"Oc"},{v:1e24,s:"Sp"},
          {v:1e21,s:"Sx"},{v:1e18,s:"Qn"},{v:1e15,s:"Qd"},{v:1e12,s:"T"},
          {v:1e9,s:"B"},{v:1e6,s:"M"},{v:1e3,s:"K"}
        ];
        for (const {v,s} of units) if (num >= v) return (num/v).toFixed(2)+s;
        return num.toString();
      }

      function formatTime(minutes) {
        if (minutes < 60) return `${minutes.toFixed(1)} minutes`;
        const hours = minutes / 60;
        if (hours < 24) return `${hours.toFixed(1)} hours`;
        const days = hours / 24;
        return `${days.toFixed(1)} days`;
      }

      // Stats Calculator Function
      function calculateGains() {
        const statType = document.getElementById("statType").value;
        const gainPerTick = parseNumberWithSuffix(document.getElementById("gainPerTick").value);
        const time = parseFloat(document.getElementById("time").value);
        const hasCompanion = document.getElementById("companionActive").value === "true";
        const companionGain = hasCompanion ? parseNumberWithSuffix(document.getElementById("companionGain").value) : 0;

        const resultDiv = document.getElementById("result");
        if (isNaN(gainPerTick)) {
          resultDiv.innerHTML = `<div class="result-item" style="color:var(--error)">Please enter a valid Gain per tick</div>`;
          resultDiv.classList.add("show");
          return;
        }

        if (isNaN(time) || time <= 0) {
          resultDiv.innerHTML = `<div class="result-item" style="color:var(--error)">Please enter a valid Time in Minutes</div>`;
          resultDiv.classList.add("show");
          return;
        }

        if (hasCompanion && isNaN(companionGain)) {
          resultDiv.innerHTML = `<div class="result-item" style="color:var(--error)">Please enter valid Companion Gains</div>`;
          resultDiv.classList.add("show");
          return;
        }

        const ticks = ticksPerMinute[statType] * time;
        const mainGain = gainPerTick * ticks;
        
        let companionTotalGain = 0;
        if (hasCompanion) {
          const companionTicks = companionTicksPerMinute * time;
          companionTotalGain = companionGain * companionTicks;
        }

        const totalGain = mainGain + companionTotalGain;

        resultDiv.innerHTML = `
          <div><span>Main Gain:</span><span>${abbreviateNumber(mainGain)}</span></div>
          <div><span>Companion:</span><span>${abbreviateNumber(companionTotalGain)}</span></div>
          <div class="bold"><span>Total:</span><span>${abbreviateNumber(totalGain)}</span></div>
        `;
  resultDiv.classList.add("show");
      }

      // Coin Calculator Function
      function calculateCoins() {
        const selectedRankIndex = parseInt(document.getElementById("rankSelect").value);
        const selectedRank = ranks[selectedRankIndex];
        const doubleCoins = document.getElementById("doubleCoins").checked;
        const goldCompanion = document.getElementById("goldCompanion").checked;
        const timeInput = document.getElementById("coinTimeInput").value;
        const time = parseInt(timeInput);

        const coinResultDiv = document.getElementById("coinResult");
        if (!timeInput || isNaN(time) || time <= 0) {
          coinResultDiv.innerHTML = `
            <div class="result-item">
              <span style="color: var(--error);">Please enter a valid time</span>
            </div>
          `;
          coinResultDiv.classList.add("show");
          return;
        }

        let coinsPerMinute = selectedRank.coinPerMinute;
        let bonuses = [];

        if (doubleCoins) {
          coinsPerMinute *= 2;
          bonuses.push("2x Gamepass");
        }

        if (goldCompanion) {
          coinsPerMinute *= 1.2;
          bonuses.push("Gold Companion");
        }

        const totalCoins = coinsPerMinute * time;
        const formattedCPM = abbreviateNumber(coinsPerMinute);
        const formattedTotal = abbreviateNumber(totalCoins);

        // --- Gems Calculation ---
        const doubleGems = document.getElementById("doubleGems").checked;
        let gemsPerMinute = 5 + Math.floor(selectedRankIndex / 2);
        if (doubleGems) gemsPerMinute *= 2;
        const totalGems = gemsPerMinute * time;

        coinResultDiv.style.borderLeft = '5px solid #16a085'; // green
        coinResultDiv.innerHTML = `
          <div><span>Rank:</span><span>${selectedRank.name}</span></div>
          <div><span>Coins per Minute:</span><span>${abbreviateNumber(coinsPerMinute)}</span></div>
          <div><span>Gems per Minute:</span><span>${abbreviateNumber(gemsPerMinute)}</span></div>
          <div><span>Time:</span><span>${time} minutes</span></div>
          <div class="bold"><span>Total Coins:</span><span>${abbreviateNumber(totalCoins)}</span></div>
          <div class="bold"><span>Total Gems:</span><span>${abbreviateNumber(totalGems)}</span></div>
        `;
        coinResultDiv.classList.add("show");
      }

      // Goal Calculator Function
      function calculateTimeToGoal() {
        const statType = document.getElementById("goalStatType").value;
        const gainPerTick = parseNumberWithSuffix(document.getElementById("goalGainPerTick").value);
        const companionGain = parseNumberWithSuffix(document.getElementById("goalCompanionGain").value) || 0;
        const currentStat = parseNumberWithSuffix(document.getElementById("currentStat").value);
        const desiredStat = parseNumberWithSuffix(document.getElementById("desiredStat").value);

        if (isNaN(gainPerTick)) {
          document.getElementById("goalResult").innerHTML = `<div class="result-item" style="color:var(--error)">Please enter a valid gain per tick</div>`;
          return;
        }

        if (isNaN(currentStat)) {
          document.getElementById("goalResult").innerHTML = `<div class="result-item" style="color:var(--error)">Please enter your current stat value</div>`;
          return;
        }

        if (isNaN(desiredStat) || desiredStat <= currentStat) {
          document.getElementById("goalResult").innerHTML = `<div class="result-item" style="color:var(--error)">Please enter a valid desired stat higher than current</div>`;
          return;
        }

        const neededGain = desiredStat - currentStat;
        const gainPerMinute = (gainPerTick * ticksPerMinute[statType]) + (companionGain * companionTicksPerMinute);
        const minutesNeeded = neededGain / gainPerMinute;

        document.getElementById("goalResult").innerHTML = `
          <div class="result-item">
            <span class="result-label">Training Type:</span>
            <span class="result-value">${statType.charAt(0).toUpperCase()+statType.slice(1)}</span>
          </div>
          <div class="result-item">
            <span class="result-label">Current Stat:</span>
            <span class="result-value">${abbreviateNumber(currentStat)}</span>
          </div>
          <div class="result-item">
            <span class="result-label">Desired Stat:</span>
            <span class="result-value">${abbreviateNumber(desiredStat)}</span>
          </div>
          <div class="result-item">
            <span class="result-label">Gain Needed:</span>
            <span class="result-value">${abbreviateNumber(neededGain)}</span>
          </div>
          <div class="result-item">
            <span class="result-label">Gain Per Minute:</span>
            <span class="result-value">${abbreviateNumber(gainPerMinute)}</span>
          </div>
          <div class="result-item" style="margin-top:1rem;padding-top:0.75rem;border-top:1px solid var(--border)">
            <span class="result-label" style="font-weight:700">Time Needed:</span>
            <span class="result-value" style="font-weight:700">${formatTime(minutesNeeded)}</span>
          </div>
          <div class="result-item">
            <span class="result-label">At This Rate You'll Reach It:</span>
            <span class="result-value">${new Date(Date.now() + minutesNeeded * 60000).toLocaleString()}</span>
          </div>
        `;
  document.getElementById("goalResult").classList.add("show");
      }


      // Trading Calculator Functionality (hernoemd naar 'item')
      // Alle items (companions en auras)
      const items = [
        // Companions
        { type: 'companion', name: "Better World", image: "images/better_world.png", rarity:5000, training:200, damage:150, passives:100, limited:0, synergy:0 },
        { type: 'companion', name: "BroBro", image: "images/brobro.png", rarity:5000, training:180, damage:125, passives:100, limited:0, synergy:0 },
        { type: 'companion', name: "Demon Galo", image: "images/demon_galo.png", rarity:5000, training:180, damage:150, passives:100, limited:0, synergy:0 },
        { type: 'companion', name: "Naru Baryon", image: "images/naru_baryon.png", rarity:1000, training:140, damage:150, passives:100, limited:0, synergy:0 },
        { type: 'companion', name: "Super Baybe", image: "images/super_baybe.png", rarity:1000, training:125, damage:125, passives:100, limited:0, synergy:0 },
        { type: 'companion', name: "Emp Teach", image: "images/emp_teach.png", rarity:1000, training:120, damage:125, passives:100, limited:0, synergy:0 },
        { type: 'companion', name: "Ultra Gogo", image: "images/ultra_gogo.png", rarity:100, training:235, damage:0, passives:100, limited:0, synergy:0 },
        { type: 'companion', name: "Freeah", image: "images/freeah.png", rarity:100, training:220, damage:80, passives:100, limited:0, synergy:0 },
        { type: 'companion', name: "Momo", image: "images/momo.png", rarity:25, training:70, damage:100, passives:30, limited:0, synergy:50 },
        { type: 'companion', name: "Ana", image: "images/ana.png", rarity:25, training:75, damage:0, passives:30, limited:0, synergy:0 },
        { type: 'companion', name: "Demin Odis", image: "images/demin_odis.png", rarity:25, training:85, damage:60, passives:100, limited:25, synergy:0 },
        { type: 'companion', name: "Aizo", image: "images/aizo.png", rarity:25, training:85, damage:100, passives:30, limited:0, synergy:100 },
        { type: 'companion', name: "Turbo", image: "images/turbo.png", rarity:25, training:180, damage:0, passives:100, limited:100, synergy:0 },
        { type: 'companion', name: "Jojo", image: "images/jojo.png", rarity:25, training:80, damage:0, passives:60, limited:0, synergy:0 },
        { type: 'companion', name: "Tobi", image: "images/tobi.png", rarity:25, training:145, damage:0, passives:60, limited:25, synergy:0 },
        { type: 'companion', name: "Sid", image: "images/sid.png", rarity:25, training:75, damage:40, passives:100, limited:800, synergy:0 },
        { type: 'companion', name: "Prevy Prevy", image: "images/prevy_prevy.png", rarity:25, training:80, damage:150, passives:60, limited:25, synergy:50 },
        { type: 'companion', name: "Mahaga", image: "images/mahaga.png", rarity:25, training:75, damage:0, passives:100, limited:250, synergy:0 },
        { type: 'companion', name: "Iglo", image: "images/iglo.png", rarity:25, training:135, damage:40, passives:60, limited:25, synergy:50 },
        { type: 'companion', name: "Eddy", image: "images/eddy.png", rarity:25, training:85, damage:0, passives:0, limited:0, synergy:0 },
        { type: 'companion', name: "Mino", image: "images/mino.png", rarity:25, training:135, damage:0, passives:100, limited:0, synergy:0 },
        { type: 'companion', name: "Bowal", image: "images/bowal.png", rarity:25, training:95, damage:100, passives:30, limited:25, synergy:50 },
        { type: 'companion', name: "Naru Cloaked", image: "images/naru_cloaked.png", rarity:70, training:75, damage:80, passives:50, limited:40, synergy:70 },
        { type: 'companion', name: "Baybe", image: "images/baybe.png", rarity:70, training:75, damage:80, passives:50, limited:40, synergy:70 },
        { type: 'companion', name: "Powa", image: "images/powa.png", rarity:70, training:75, damage:80, passives:50, limited:40, synergy:70 },
        { type: 'companion', name: "Mama", image: "images/mama.png", rarity:70, training:75, damage:80, passives:50, limited:40, synergy:70 },
        { type: 'companion', name: "Seidon", image: "images/seidon.png", rarity:70, training:75, damage:80, passives:50, limited:40, synergy:70 },
        { type: 'companion', name: "Toasta", image: "images/toasta.png", rarity:70, training:75, damage:80, passives:50, limited:40, synergy:70 },
        { type: 'companion', name: "Teach", image: "images/teach.png", rarity:70, training:75, damage:80, passives:50, limited:40, synergy:70 },
        { type: 'companion', name: "Meggy", image: "images/meggy.png", rarity:70, training:75, damage:80, passives:50, limited:40, synergy:70 },
        { type: 'companion', name: "HLucy", image: "images/lucy.png", rarity:70, training:75, damage:80, passives:50, limited:40, synergy:70 },
        { type: 'companion', name: "Subra", image: "images/subra.png", rarity:70, training:75, damage:80, passives:50, limited:40, synergy:70 },
        { type: 'companion', name: "Jing", image: "images/jing.png", rarity:70, training:75, damage:80, passives:50, limited:40, synergy:70 },
        { type: 'companion', name: "Sinju", image: "images/sinju.png", rarity:70, training:75, damage:80, passives:50, limited:40, synergy:70 },
        { type: 'companion', name: "Sanju", image: "images/sanju.png", rarity:70, training:75, damage:80, passives:50, limited:40, synergy:70 },
        { type: 'companion', name: "Astro", image: "images/astro.png", rarity:70, training:75, damage:80, passives:50, limited:40, synergy:70 },
        { type: 'companion', name: "Yoo Ho", image: "images/yoo_ho.png", rarity:70, training:75, damage:80, passives:50, limited:40, synergy:70 },
        { type: 'companion', name: "Rimo", image: "images/rimo.png", rarity:70, training:75, damage:80, passives:50, limited:40, synergy:70 },
        { type: 'companion', name: "Shunks", image: "images/shunks.png", rarity:70, training:75, damage:80, passives:50, limited:40, synergy:70 },
        { type: 'companion', name: "Gong", image: "images/gong.png", rarity:70, training:75, damage:80, passives:50, limited:40, synergy:70 },
        { type: 'companion', name: "Saka", image: "images/saka.png", rarity:70, training:75, damage:80, passives:50, limited:40, synergy:70 },
        { type: 'companion', name: "Keela", image: "images/keela.png", rarity:70, training:75, damage:80, passives:50, limited:40, synergy:70 },
        { type: 'companion', name: "Nejo", image: "images/nejo.png", rarity:70, training:75, damage:80, passives:50, limited:40, synergy:70 },
        { type: 'companion', name: "Yujay", image: "images/yujay.png", rarity:70, training:75, damage:80, passives:50, limited:40, synergy:70 },
        { type: 'companion', name: "Sausage", image: "images/sausage.png", rarity:70, training:75, damage:80, passives:50, limited:40, synergy:70 },
        { type: 'companion', name: "Ego", image: "images/ego.png", rarity:70, training:75, damage:80, passives:50, limited:40, synergy:70 },
        { type: 'companion', name: "Nasa", image: "images/nasa.png", rarity:70, training:75, damage:80, passives:50, limited:40, synergy:70 },
        { type: 'companion', name: "Veggies", image: "images/veggies.png", rarity:70, training:75, damage:80, passives:50, limited:40, synergy:70 },
        { type: 'companion', name: "Gogo", image: "images/gogo.png", rarity:70, training:75, damage:80, passives:50, limited:40, synergy:70 },
        { type: 'companion', name: "Naru", image: "images/naru.png", rarity:70, training:75, damage:80, passives:50, limited:40, synergy:70 },
        { type: 'companion', name: "Lucy", image: "images/lucy.png", rarity:70, training:75, damage:80, passives:50, limited:40, synergy:70 },
        { type: 'companion', name: "Zolo", image: "images/zolo.png", rarity:70, training:75, damage:80, passives:50, limited:40, synergy:70 },
        { type: 'companion', name: "Nezu", image: "images/nezu.png", rarity:70, training:75, damage:80, passives:50, limited:40, synergy:70 },
        { type: 'companion', name: "Hawker", image: "images/hawker.png", rarity:70, training:75, damage:80, passives:50, limited:40, synergy:70 },
        { type: 'companion', name: "Etzy", image: "images/etzy.png", rarity:70, training:75, damage:80, passives:50, limited:40, synergy:70 },
        { type: 'companion', name: "Spade", image: "images/spade.png", rarity:70, training:75, damage:80, passives:50, limited:40, synergy:70 },
        { type: 'companion', name: "Lee", image: "images/lee.png", rarity:70, training:75, damage:80, passives:50, limited:40, synergy:70 },
        { type: 'companion', name: "Jing", image: "images/jing.png", rarity:70, training:75, damage:80, passives:50, limited:40, synergy:70 },
        { type: 'companion', name: "Martha", image: "images/martha.png", rarity:70, training:75, damage:80, passives:50, limited:40, synergy:70 },
        
        // Auras
        { type: 'aura', name: "Placeholder Aura", image: "https://via.placeholder.com/50x50?text=Aura" }
        // Voeg hier meer auras toe met type: 'aura'
      ];

      let currentPanel = null;
      let currentTab = 'companion';
      const yourOffer = [];
      const theirOffer = [];
      const modal = document.getElementById('item-modal');
      const itemGrid = document.getElementById('item-grid');

      // Modal tab buttons
      const btnCompanions = document.getElementById('btn-companions');
      const btnAuras = document.getElementById('btn-auras');
      const modalTitle = document.querySelector('.modal-title');

      btnCompanions.addEventListener('click', function() {
        btnCompanions.classList.add('active');
        btnAuras.classList.remove('active');
        currentTab = 'companion';
        modalTitle.textContent = 'Select Item';
        populateItemGrid();
      });
      btnAuras.addEventListener('click', function() {
        btnAuras.classList.add('active');
        btnCompanions.classList.remove('active');
        currentTab = 'aura';
        modalTitle.textContent = 'Select Item';
        populateItemGrid();
      });

      // Open modal
      document.getElementById('add-your-companion').addEventListener('click', () => {
        currentPanel = 'yours';
        modal.style.display = 'flex';
        // Standaard companions tab
        btnCompanions.classList.add('active');
        btnAuras.classList.remove('active');
        currentTab = 'companion';
        modalTitle.textContent = 'Select Item';
        populateItemGrid();
      });
      document.getElementById('add-their-companion').addEventListener('click', () => {
        currentPanel = 'theirs';
        modal.style.display = 'flex';
        btnCompanions.classList.add('active');
        btnAuras.classList.remove('active');
        currentTab = 'companion';
        modalTitle.textContent = 'Select Item';
        populateItemGrid();
      });

      // Close modal
      document.getElementById('close-modal').addEventListener('click', () => modal.style.display='none');

      // Populate modal grid (toon items van huidig tab)
      function populateItemGrid() {
        itemGrid.innerHTML = '';
        const filtered = items.filter(i => i.type === currentTab);
        filtered.forEach(item => {
          const div = document.createElement('div');
          div.className = 'item-option';
          div.innerHTML = `
            <img src="${item.image}" alt="${item.name}" width="50" height="50">
            <span>${item.name}</span>
          `;
          div.addEventListener('click', () => {
            addItemToOffer(item);
            modal.style.display = 'none';
          });
          itemGrid.appendChild(div);
        });
      }

      // Add item to offer
      function addItemToOffer(item) {
        const offer = currentPanel === 'yours' ? yourOffer : theirOffer;
        const imagesContainer = currentPanel === 'yours' ? document.getElementById('your-offer-images') : document.getElementById('their-offer-images');
        const existingIndex = offer.findIndex(c => c.name === item.name && c.type === item.type);
        if(existingIndex >= 0) {
          offer[existingIndex].amount += 1;
        } else {
          offer.push({ ...item, amount:1, trait:undefined });
        }
        updateOfferImages(offer, imagesContainer);
      }

      // Contextmenu en edit-modal logica
      let editModal = null;
      let editModalOverlay = null;
      let editModalTrait = null;
      let editModalAmount = null;
      let editModalApplyBtn = null;
      let editModalAmountBadge = null;
      let editModalCurrent = null;
  // let editModalOffer = null;
  // let editModalIndex = null;

      // Helper: maak of toon edit modal
      function showEditModal(item, offer, index, updateImagesFn, imagesContainer) {
  // Verwijder oude modal als die bestaat
  if (editModalOverlay && editModalOverlay.parentNode) editModalOverlay.parentNode.removeChild(editModalOverlay);
  if (editModal && editModal.parentNode) editModal.parentNode.removeChild(editModal);
  editModal = null;
  editModalOverlay = null;

  // Altijd nieuwe modal aanmaken
  {
          // Overlay
          editModalOverlay = document.createElement('div');
          editModalOverlay.style.position = 'fixed';
          editModalOverlay.style.top = 0;
          editModalOverlay.style.left = 0;
          editModalOverlay.style.width = '100vw';
          editModalOverlay.style.height = '100vh';
          editModalOverlay.style.background = 'rgba(0,0,0,0.7)';
          editModalOverlay.style.zIndex = 9999;
          editModalOverlay.addEventListener('click', closeEditModal);

          // Modal
          editModal = document.createElement('div');
          editModal.style.position = 'fixed';
          editModal.style.top = '50%';
          editModal.style.left = '50%';
          editModal.style.transform = 'translate(-50%,-50%)';
          editModal.style.background = '#23232e';
          editModal.style.border = '2px solid #42e695';
          editModal.style.borderRadius = '1.2rem';
          editModal.style.padding = '2.2rem 2.5rem 2.2rem 2.5rem';
          editModal.style.display = 'flex';
          editModal.style.flexDirection = 'row';
          editModal.style.alignItems = 'center';
          editModal.style.gap = '2.5rem';
          editModal.style.zIndex = 10000;
          editModal.style.minWidth = '420px';
          editModal.style.boxShadow = '0 0 40px #000b, 0 0 0 4px #42e69544';

          // Left: grote afbeelding
          const left = document.createElement('div');
          left.style.display = 'flex';
          left.style.flexDirection = 'column';
          left.style.alignItems = 'center';
          left.style.justifyContent = 'center';
          left.style.position = 'relative';
          left.style.minWidth = '140px';
          left.style.maxWidth = '180px';
          left.style.gap = '0.7rem';
          const img = document.createElement('img');
          img.style.width = '120px';
          img.style.height = '120px';
          img.style.objectFit = 'contain';
          img.style.borderRadius = '1rem';
          img.style.background = '#18181f';
          img.style.border = '2px solid #35354a';
          img.id = 'edit-modal-img';
          left.appendChild(img);
          // Amount badge rechtsboven
          editModalAmountBadge = document.createElement('div');
          editModalAmountBadge.style.position = 'absolute';
          editModalAmountBadge.style.top = '-10px';
          editModalAmountBadge.style.right = '-10px';
          editModalAmountBadge.style.background = '#42e695';
          editModalAmountBadge.style.color = '#111';
          editModalAmountBadge.style.fontWeight = 'bold';
          editModalAmountBadge.style.fontSize = '1.1rem';
          editModalAmountBadge.style.borderRadius = '50%';
          editModalAmountBadge.style.width = '36px';
          editModalAmountBadge.style.height = '36px';
          editModalAmountBadge.style.display = 'flex';
          editModalAmountBadge.style.alignItems = 'center';
          editModalAmountBadge.style.justifyContent = 'center';
          left.appendChild(editModalAmountBadge);

          // Right: trait en amount
          const right = document.createElement('div');
          right.style.display = 'flex';
          right.style.flexDirection = 'column';
          right.style.gap = '1.2rem';
          right.style.minWidth = '180px';
          right.style.maxWidth = '220px';

          // Trait
          const traitLabel = document.createElement('label');
          traitLabel.textContent = 'Trait:';
          traitLabel.style.fontWeight = 'bold';
          traitLabel.style.marginBottom = '0.2rem';
          traitLabel.style.color = '#fff';
          editModalTrait = document.createElement('select');
          editModalTrait.style.fontSize = '1.1rem';
          editModalTrait.style.padding = '0.4rem 0.7rem';
          editModalTrait.style.borderRadius = '0.5rem';
          editModalTrait.style.background = '#23232e';
          editModalTrait.style.color = '#fff';
          editModalTrait.style.border = '1.5px solid #42e695';
          editModalTrait.innerHTML = `
            <option value="none">Normal</option>
            <option value="gold">Gold (1.3)</option>
            <option value="atomic">Atomic (1.5)</option>
          `;
          right.appendChild(traitLabel);
          right.appendChild(editModalTrait);

          // Amount
          const amountLabel = document.createElement('label');
          amountLabel.textContent = 'Amount:';
          amountLabel.style.fontWeight = 'bold';
          amountLabel.style.marginBottom = '0.2rem';
          amountLabel.style.color = '#fff';
          editModalAmount = document.createElement('input');
          editModalAmount.type = 'number';
          editModalAmount.min = '1';
          editModalAmount.max = '99';
          editModalAmount.style.fontSize = '1.1rem';
          editModalAmount.style.padding = '0.4rem 0.7rem';
          editModalAmount.style.borderRadius = '0.5rem';
          editModalAmount.style.background = '#23232e';
          editModalAmount.style.color = '#fff';
          editModalAmount.style.border = '1.5px solid #42e695';
          editModalAmount.style.width = '80px';
          right.appendChild(amountLabel);
          right.appendChild(editModalAmount);

          // Apply button
          editModalApplyBtn = document.createElement('button');
          editModalApplyBtn.textContent = 'Apply';
          editModalApplyBtn.style.marginTop = '1.5rem';
          editModalApplyBtn.style.background = 'linear-gradient(135deg, #42e695, #42e695)';
          editModalApplyBtn.style.color = '#111';
          editModalApplyBtn.style.fontWeight = 'bold';
          editModalApplyBtn.style.fontSize = '1.1rem';
          editModalApplyBtn.style.padding = '0.7rem 2.2rem';
          editModalApplyBtn.style.border = 'none';
          editModalApplyBtn.style.borderRadius = '0.7rem';
          editModalApplyBtn.style.cursor = 'pointer';
          editModalApplyBtn.addEventListener('click', applyEditModal);
          right.appendChild(editModalApplyBtn);

          // Close X
          const closeBtn = document.createElement('button');
          closeBtn.textContent = '';
          closeBtn.style.position = 'absolute';
          closeBtn.style.top = '10px';
          closeBtn.style.right = '18px';
          closeBtn.style.background = 'none';
          closeBtn.style.border = 'none';
          closeBtn.style.color = '#fff';
          closeBtn.style.fontSize = '2.1rem';
          closeBtn.style.cursor = 'pointer';
          closeBtn.addEventListener('click', closeEditModal);
          editModal.appendChild(closeBtn);

          editModal.appendChild(left);
          editModal.appendChild(right);
        }
  // Vul modal met juiste data
  editModalCurrent = item;
  // editModalOffer = offer;
  // editModalIndex = index;
  editModal.querySelector('#edit-modal-img').src = item.image;
  editModal.querySelector('#edit-modal-img').alt = item.name;
  editModalAmountBadge.textContent = item.amount;
  editModalTrait.value = item.trait || 'none';
  editModalAmount.value = item.amount;

        // Toon modal
        document.body.appendChild(editModalOverlay);
        document.body.appendChild(editModal);

        // Focus op input
        setTimeout(()=>{editModalAmount.focus();}, 100);

        // Apply-functie
        function applyEditModal() {
          // Pas trait en amount aan
          const newTrait = editModalTrait.value === 'none' ? undefined : editModalTrait.value;
          let newAmount = parseInt(editModalAmount.value);
          if(isNaN(newAmount) || newAmount < 1) newAmount = 1;
          if(newAmount > 99) newAmount = 99;
          offer[index].trait = newTrait;
          offer[index].amount = newAmount;
          closeEditModal();
          updateImagesFn(offer, imagesContainer);
        }
        function closeEditModal() {
          if(editModalOverlay && editModalOverlay.parentNode) editModalOverlay.parentNode.removeChild(editModalOverlay);
          if(editModal && editModal.parentNode) editModal.parentNode.removeChild(editModal);
        }
      }

      // Toon alle gekozen items als images bovenaan, met contextmenu en badge voor aantal
      function updateOfferImages(offer, imagesContainer) {
        imagesContainer.innerHTML = '';
        offer.forEach((c,index) => {
          // 1 image per item, met badge
          const wrapper = document.createElement('div');
          wrapper.style.position = 'relative';
          wrapper.style.display = 'inline-block';
          wrapper.style.marginRight = '10px';
          wrapper.style.marginBottom = '10px';
          wrapper.style.paddingTop = '16px'; // Extra ruimte boven voor badge

          const img = document.createElement('img');
          img.src = c.image;
          img.alt = c.name;
          img.title = c.name;
          img.style.width = '80px';
          img.style.height = '80px';
          img.style.objectFit = 'contain';
          img.style.borderRadius = '8px';
          img.style.cursor = 'pointer';
          img.style.border = '2px solid #35354a';
          img.style.background = '#18181f';

          // Badge
          if (c.amount > 1) {
            const badge = document.createElement('div');
            badge.textContent = c.amount;
            badge.style.position = 'absolute';
            badge.style.top = '12px'; // Hoger plaatsen
            badge.style.right = '-12px';
            badge.style.background = '#42e695';
            badge.style.color = '#111';
            badge.style.fontWeight = 'bold';
            badge.style.fontSize = '1.1rem';
            badge.style.borderRadius = '50%';
            badge.style.width = '32px';
            badge.style.height = '32px';
            badge.style.display = 'flex';
            badge.style.alignItems = 'center';
            badge.style.justifyContent = 'center';
            badge.style.zIndex = '3';
            wrapper.appendChild(badge);
          }

          img.addEventListener('click', (e) => {
            e.preventDefault();
            // Contextmenu: Edit of Delete
            const menu = document.createElement('div');
            menu.style.position = 'fixed';
            menu.style.left = e.clientX + 'px';
            menu.style.top = e.clientY + 'px';
            menu.style.background = '#23232e';
            menu.style.border = '1.5px solid #42e695';
            menu.style.borderRadius = '0.5rem';
            menu.style.boxShadow = '0 2px 16px #000b';
            menu.style.zIndex = 99999;
            menu.style.display = 'flex';
            menu.style.flexDirection = 'column';
            menu.style.minWidth = '110px';
            menu.style.overflow = 'hidden';


            const editBtn = document.createElement('button');
            editBtn.textContent = 'Edit';
            editBtn.style.background = 'none';
            editBtn.style.border = 'none';
            editBtn.style.color = '#42e695';
            editBtn.style.fontWeight = 'bold';
            editBtn.style.fontSize = '1.1rem';
            editBtn.style.padding = '0.7rem 1.2rem';
            editBtn.style.cursor = 'pointer';
            editBtn.addEventListener('click', () => {
              document.body.removeChild(menu);
              showEditModal(c, offer, index, updateOfferImages, imagesContainer);
            });
            menu.appendChild(editBtn);

            const delBtn = document.createElement('button');
            delBtn.textContent = 'Delete';
            delBtn.style.background = 'none';
            delBtn.style.border = 'none';
            delBtn.style.color = '#ef4444';
            delBtn.style.fontWeight = 'bold';
            delBtn.style.fontSize = '1.1rem';
            delBtn.style.padding = '0.7rem 1.2rem';
            delBtn.style.cursor = 'pointer';
            delBtn.addEventListener('click', () => {
              offer.splice(index,1);
              document.body.removeChild(menu);
              updateOfferImages(offer, imagesContainer);
            });
            menu.appendChild(delBtn);

            // Verwijder menu bij klik buiten
            function removeMenu(e2) {
              if (!menu.contains(e2.target)) {
                document.body.removeChild(menu);
                document.removeEventListener('mousedown', removeMenu);
              }
            }
            setTimeout(()=>{
              document.addEventListener('mousedown', removeMenu);
            }, 10);

            document.body.appendChild(menu);
          });
          wrapper.appendChild(img);
          imagesContainer.appendChild(wrapper);
        });
      }

      // Calculate total per item (alleen companions hebben stats)
      function calculateTotal(c) {
        if(c.type === 'aura') return 100; // placeholder waarde voor auras
        const weights = { rarity:0.2, training:0.25, damage:0.25, passives:0.15, limited:0.1, synergy:0.05 };
        return c.rarity*weights.rarity + c.training*weights.training + c.damage*weights.damage + c.passives*weights.passives + c.limited*weights.limited + c.synergy*weights.synergy;
      }

      // Calculate trade
      document.getElementById('calculate-trade').addEventListener('click', ()=>{
        if(yourOffer.length===0 || theirOffer.length===0){ alert("Add items to both sides"); return; }
        const yourTotal = yourOffer.reduce((sum,c)=>{
          let val = calculateTotal(c)*c.amount;
          if(c.trait==='gold') val*=1.3;
          else if(c.trait==='atomic') val*=1.5;
          return sum+val;
        },0);
        const theirTotal = theirOffer.reduce((sum,c)=>{
          let val = calculateTotal(c)*c.amount;
          if(c.trait==='gold') val*=1.3;
          else if(c.trait==='atomic') val*=1.5;
          return sum+val;
        },0);
        const difference = theirTotal - yourTotal;
        document.getElementById('your-value').textContent = yourTotal.toFixed(1);
        document.getElementById('their-value').textContent = theirTotal.toFixed(1);
        document.getElementById('difference-value').textContent = Math.abs(difference).toFixed(1);
        let resultText='Fair Trade'; let color='#7e22ce';
        if(difference>0){ resultText='Good Trade (You Profit)'; color='#22c55e'; }
        else if(difference<0){ resultText='Bad Trade (You Lose)'; color='#ef4444'; }
        document.getElementById('trade-result-text').textContent=resultText;
        document.getElementById('trade-result-text').style.color=color;
        document.getElementById('trade-result').classList.add('show');
      });

      // Init: companions tab standaard
      populateItemGrid();

      // Event Listeners
      document.getElementById("calculateBtn").addEventListener("click", calculateGains);
      document.getElementById("calculateCoinsBtn").addEventListener("click", calculateCoins);

      // Prevent all input/textarea fields from being auto-filled or auto-completed
      document.querySelectorAll('input, textarea').forEach(function(el) {
        el.setAttribute('autocomplete', 'off');
        el.setAttribute('autocorrect', 'off');
        el.setAttribute('autocapitalize', 'off');
        el.setAttribute('spellcheck', 'false');
      });
      
      // Enter key support
      const inputs = [
        "gainPerTick", "time", "companionGain", 
        "goalGainPerTick", "goalCompanionGain", "currentStat", "desiredStat",
        "coinTimeInput"
      ];
      
      inputs.forEach(id => {
        document.getElementById(id).addEventListener("keypress", function(e) {
          if (e.key === "Enter") {
            if (id === "coinTimeInput") {
              calculateCoins();
            } else if (id === "gainPerTick" || id === "time" || id === "companionGain") {
              calculateGains();
            } else {
              calculateTimeToGoal();
            }
          }
        });
      });
    });
  </script>
  <style>
  .hamburger-menu {
    position: fixed;
    top: 24px;
    right: 32px;
    width: 54px;
    height: 54px;
    z-index: 20000;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    background: #1c1c1c;
    border-radius: 10px;
    cursor: pointer;
    border: 3px solid #fff;
    overflow: visible;
    box-shadow: none;
    transition: border-color 1.5s cubic-bezier(.4,1.6,.4,1), box-shadow 1.5s cubic-bezier(.4,1.6,.4,1), transform 0.2s;
    /* Geen scale/transform op hover */
  }
  .hamburger-menu:hover {
    border-color: #42e695;
    box-shadow: 0 0 0 4px #42e69544, 0 0 18px #42e69588, 0 0 36px #42e69544;
    transform: scale(1.12);
    transition: border-color 0.2s, box-shadow 0.2s, transform 0.2s;
  }
  .hamburger-stripes {
    width: 32px;
    height: 28px;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    align-items: center;
    z-index: 1;
    margin-top: 8px;
    margin-bottom: 8px;
    gap: 6px;
  }
  .hamburger-stripe {
    width: 100%;
    height: 5px;
    padding-top: 6px;
    border-radius: 3px;
    background: #fff;
    box-shadow:
      0 0 8px #42e695,
      0 0 16px #7e22ce,
      0 0 24px #42e695;
    transition: box-shadow 0.2s;
    margin: 0;
  }
</style>
<div class="hamburger-menu" id="hamburgerMenu">
  <div class="hamburger-stripes">
    <div class="hamburger-stripe"></div>
    <div class="hamburger-stripe"></div>
    <div class="hamburger-stripe"></div>
  </div>
</div>
<div class="side-navbar" id="sideNavbar">
  <div class="side-navbar-title" style="font-size: 3rem; font-weight: bold; color: #fff !important; text-shadow: 0 0 15px #ff6ec4, 0 0 25px #7873f5, 0 0 35px #42e695; margin: 0 0 0.5rem 0; padding-top: 0.2rem; position: relative; z-index: 5;">Menu</div>
  <div class="side-navbar-buttons" style="display: flex; flex-direction: column; font-size: 3rem; gap: 1.1rem; width: 100%;">
    <button class="btn side-nav-btn" id="btn-calculators">Calculators</button>
    <button class="btn side-nav-btn" id="btn-tierlist">Tier Lists</button>
  </div>
</div>

<script>
  const hamburgerMenu = document.getElementById('hamburgerMenu');
  const sideNavbar = document.getElementById('sideNavbar');
  let navOpen = false;
  hamburgerMenu.addEventListener('click', function(e) {
    navOpen = !navOpen;
    sideNavbar.classList.toggle('open', navOpen);
  });
  // Optioneel: klik buiten menu sluit nav
  document.addEventListener('mousedown', function(e) {
    if (navOpen && !sideNavbar.contains(e.target) && !hamburgerMenu.contains(e.target)) {
      navOpen = false;
      sideNavbar.classList.remove('open');
    }
  });

  // Side navbar button logic
  document.getElementById('btn-calculators').onclick = function() {
    window.location.href = window.location.pathname;
  };
  document.getElementById('btn-tierlist').onclick = function() {
    window.location.href = 'tierlist.html';
  };
</script>
<style>

  .side-navbar {
    position: fixed;
    top: 0;
    right: 0;
    width: 220px;
    height: 100vh;
    background: #18181f;
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    padding: 2.2rem 1.2rem 1.2rem 1.2rem;
    z-index: 30000;
    border-radius: 18px 0 0 18px;
    box-shadow:
      0 0 15px rgba(0,0,0,0.7),
      0 0 30px rgba(255,110,196,0.3),
      0 0 30px rgba(120,115,245,0.3),
      0 0 30px rgba(66,230,149,0.3);
    overflow: visible;
    transform: translateX(110%);
    transition: transform 0.35s cubic-bezier(.4,1.4,.6,1);
    pointer-events: none;
  }

  .side-navbar.open::after {
    content: '';
    position: absolute;
    top: 0;
    right: 0;
    width: 220px;
    height: 100vh;
    border-radius: 18px 0 0 18px;
    background: #18181f;
    z-index: -1;
    pointer-events: none;
  }

.side-navbar.open {
  transform: translateX(0);
  pointer-events: auto;
}

.side-nav-btn:hover {
  background: linear-gradient(135deg, #7e22ce, #42e695);
  color: #fff;
  border-color: #42e695;
  box-shadow: 0 0 0 4px #42e69544, 0 0 18px #42e69588, 0 0 36px #42e69544;
  transform: scale(1.12);
  transition: border-color 0.2s, box-shadow 0.2s, transform 0.2s;
}

/*
git add .
git commit -m ""
git push
*/

</style>
</body>
</html>


